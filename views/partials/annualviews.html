<section class="ts-card ts-card--wide" id="page-annual-views" style="display:none;">
  <div class="ts-toolbar">
    <div class="ts-stack ts-stack--sm">
      <h3 style="margin:0;">Annual Views</h3>
      <p class="ts-note" style="margin:0;">Comprehensive financial breakdown across the year with income, hours, and tax insights.</p>
    </div>
    <div class="ts-toolbar-actions">
      <button class="ghost" id="annual-contract-filter-toggle" style="display:none;" title="Filter by contract">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M1 3h14M3 8h10M5 13h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </button>
      <label class="ts-toggle">
        <input type="checkbox" id="annual-year-type-toggle" />
        <span class="ts-toggle-track">
          <span class="ts-toggle-thumb"></span>
        </span>
      </label>
      <span id="annual-year-type-label" class="ts-muted" style="font-size:13px;">Financial Year</span>
      <label class="ts-select-label">
        Year
        <select id="annual-year-select" style="min-width:160px;"></select>
      </label>
    </div>
  </div>

  <!-- Contract Filter Panel -->
  <div class="ts-annual-filter-panel" id="annual-contract-filter-panel" style="display:none;">
    <div class="ts-flex-between" style="margin-bottom:8px;">
      <span style="font-size:13px; font-weight:600;">Filter by Contract</span>
      <button class="ghost" id="annual-filter-select-all" style="padding:4px 8px; font-size:12px;">Select All</button>
    </div>
    <div class="ts-annual-filter-list" id="annual-contract-filter-list"></div>
  </div>

  <!-- Summary Statistics -->
  <div class="ts-annual-summary-grid">
    <!-- Row 1 -->
    <div class="ts-annual-stat-card">
      <div class="ts-annual-stat-label">Gross Income</div>
      <div class="ts-annual-stat-value" id="annual-stat-gross">--</div>
    </div>
    <div class="ts-annual-stat-card">
      <div class="ts-annual-stat-label">Total Superannuation</div>
      <div class="ts-annual-stat-value" id="annual-stat-super">--</div>
    </div>
    <div class="ts-annual-stat-card">
      <div class="ts-annual-stat-label">Total Tax</div>
      <div class="ts-annual-stat-value" id="annual-stat-tax">--</div>
    </div>
    <div class="ts-annual-stat-card">
      <div class="ts-annual-stat-label">Net Income</div>
      <div class="ts-annual-stat-value" id="annual-stat-net">--</div>
    </div>
    <!-- Row 2 -->
    <div class="ts-annual-stat-card">
      <div class="ts-annual-stat-label">Total Hours</div>
      <div class="ts-annual-stat-value" id="annual-stat-hours">--</div>
    </div>
    <div class="ts-annual-stat-card">
      <div class="ts-annual-stat-label">Avg Monthly Income</div>
      <div class="ts-annual-stat-value" id="annual-stat-avg-monthly">--</div>
    </div>
    <div class="ts-annual-stat-card">
      <div class="ts-annual-stat-label">Effective Tax Rate</div>
      <div class="ts-annual-stat-value" id="annual-stat-tax-rate">--</div>
    </div>
    <div class="ts-annual-stat-card">
      <div class="ts-annual-stat-label">Effective Hourly Rate</div>
      <div class="ts-annual-stat-value" id="annual-stat-hourly-rate">--</div>
    </div>
  </div>
  <!-- Detailed Income Breakdown Table -->
  <div style="margin-bottom:24px;">
    <h4 style="margin:0 0 12px 0; font-size:16px;">Income Breakdown</h4>
    <div style="overflow-x:auto;">
      <table class="ts-table" style="width:100%;">
        <thead>
          <tr>
            <th style="text-align:left;">Category</th>
            <th style="text-align:right;">Amount</th>
            <th style="text-align:left; width:180px;">Percentage</th>
          </tr>
        </thead>
        <tbody id="annual-income-breakdown-table">
          <tr>
            <td>Gross Income</td>
            <td id="annual-breakdown-gross" style="text-align:right;">--</td>
            <td id="annual-breakdown-gross-pct-cell" style="padding:8px 12px;">
              <div style="display:flex; align-items:center; gap:8px;">
                <div style="flex:1; height:8px; background:var(--border); border-radius:4px; overflow:hidden;">
                  <div id="annual-breakdown-gross-bar" style="height:100%; background:linear-gradient(90deg, #3b82f6, #60a5fa); width:0%; transition:width 0.6s ease;"></div>
                </div>
                <span id="annual-breakdown-gross-pct" style="font-size:13px; font-weight:500; min-width:45px; text-align:right;">--</span>
              </div>
            </td>
          </tr>
          <tr>
            <td style="padding-left:20px;">Superannuation (Guarantee + Extra)</td>
            <td id="annual-breakdown-super" style="text-align:right;">--</td>
            <td id="annual-breakdown-super-pct-cell" style="padding:8px 12px;">
              <div style="display:flex; align-items:center; gap:8px;">
                <div style="flex:1; height:8px; background:var(--border); border-radius:4px; overflow:hidden;">
                  <div id="annual-breakdown-super-bar" style="height:100%; background:linear-gradient(90deg, #10b981, #34d399); width:0%; transition:width 0.6s ease;"></div>
                </div>
                <span id="annual-breakdown-super-pct" style="font-size:13px; font-weight:500; min-width:45px; text-align:right;">--</span>
              </div>
            </td>
          </tr>
          <tr id="annual-breakdown-super-lost-row" style="display:none;">
            <td style="padding-left:20px;">Superannuation Lost (Deductions)</td>
            <td id="annual-breakdown-super-lost" style="text-align:right;">--</td>
            <td id="annual-breakdown-super-lost-pct-cell" style="padding:8px 12px;">
              <div style="display:flex; align-items:center; gap:8px;">
                <div style="flex:1; height:8px; background:var(--border); border-radius:4px; overflow:hidden;">
                  <div id="annual-breakdown-super-lost-bar" style="height:100%; background:linear-gradient(90deg, #64748b, #94a3b8); width:0%; transition:width 0.6s ease;"></div>
                </div>
                <span id="annual-breakdown-super-lost-pct" style="font-size:13px; font-weight:500; min-width:45px; text-align:right;">--</span>
              </div>
            </td>
          </tr>
          <tr>
            <td style="padding-left:20px;">Deductions</td>
            <td id="annual-breakdown-deductions" style="text-align:right;">--</td>
            <td id="annual-breakdown-deductions-pct-cell" style="padding:8px 12px;">
              <div style="display:flex; align-items:center; gap:8px;">
                <div style="flex:1; height:8px; background:var(--border); border-radius:4px; overflow:hidden;">
                  <div id="annual-breakdown-deductions-bar" style="height:100%; background:linear-gradient(90deg, #f59e0b, #fbbf24); width:0%; transition:width 0.6s ease;"></div>
                </div>
                <span id="annual-breakdown-deductions-pct" style="font-size:13px; font-weight:500; min-width:45px; text-align:right;">--</span>
              </div>
            </td>
          </tr>
          <tr>
            <td style="padding-left:20px;">Tax</td>
            <td id="annual-breakdown-tax" style="text-align:right;">--</td>
            <td id="annual-breakdown-tax-pct-cell" style="padding:8px 12px;">
              <div style="display:flex; align-items:center; gap:8px;">
                <div style="flex:1; height:8px; background:var(--border); border-radius:4px; overflow:hidden;">
                  <div id="annual-breakdown-tax-bar" style="height:100%; background:linear-gradient(90deg, #ef4444, #f87171); width:0%; transition:width 0.6s ease;"></div>
                </div>
                <span id="annual-breakdown-tax-pct" style="font-size:13px; font-weight:500; min-width:45px; text-align:right;">--</span>
              </div>
            </td>
          </tr>
          <tr style="font-weight:600; border-top:2px solid var(--border);">
            <td>Net Income</td>
            <td id="annual-breakdown-net" style="text-align:right;">--</td>
            <td id="annual-breakdown-net-pct-cell" style="padding:8px 12px;">
              <div style="display:flex; align-items:center; gap:8px;">
                <div style="flex:1; height:8px; background:var(--border); border-radius:4px; overflow:hidden;">
                  <div id="annual-breakdown-net-bar" style="height:100%; background:linear-gradient(90deg, #8b5cf6, #a78bfa); width:0%; transition:width 0.6s ease;"></div>
                </div>
                <span id="annual-breakdown-net-pct" style="font-size:13px; font-weight:600; min-width:45px; text-align:right;">--</span>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Monthly Income Chart -->
  <div style="margin-bottom:24px;">
    <h4 style="margin:0 0 4px 0; font-size:16px; font-weight:600;">Monthly Income Breakdown</h4>
    <div class="ts-note" style="margin-bottom:8px;">Months with actual income data are shown with a border</div>
    <div style="background:var(--bg); border:1px solid var(--border); border-radius:12px; padding:24px; height:420px; position:relative; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
      <canvas id="annual-income-chart"></canvas>
    </div>
  </div>

  <div id="annual-category-section" style="margin-bottom:24px; display:none;">
    <h4 style="margin:0 0 12px 0; font-size:16px; font-weight:600;">Expense Categories</h4>
    <p class="ts-note" style="margin:0 0 12px 0;">Company expenses are shown excluding GST. Use the filters below to focus on specific categories.</p>
    <div class="ts-annual-filter-panel" id="annual-category-filter-wrapper" style="display:none;">
      <div class="ts-flex-between ts-flex-wrap" style="margin-bottom:8px;">
        <span style="font-size:13px; font-weight:600;">Filter categories</span>
        <div style="display:flex; gap:8px;">
          <button class="ghost small" id="annual-category-filter-select-all">Select all</button>
          <button class="ghost small" id="annual-category-filter-clear">Clear</button>
        </div>
      </div>
      <div class="ts-annual-filter-list" id="annual-category-filter-list"></div>
    </div>
    <div style="overflow-x:auto; background:var(--bg); border:1px solid var(--border); border-radius:12px;">
      <table id="annual-category-table" style="width:100%; border-collapse:collapse; min-width:480px;">
        <thead id="annual-category-table-head"></thead>
        <tbody id="annual-category-table-body"></tbody>
      </table>
    </div>
    <div class="ts-note" id="annual-category-empty" style="display:none; margin-top:12px;">No categories to display.</div>
  </div>

  <!-- Charts Grid -->
  <div class="ts-annual-chart-grid">
    <!-- Income Distribution Pie Chart -->
    <div>
      <h4 style="margin:0 0 12px 0; font-size:16px; font-weight:600;">Income Distribution</h4>
      <div style="background:var(--bg); border:1px solid var(--border); border-radius:12px; padding:20px; height:380px; position:relative; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        <canvas id="annual-income-pie-chart"></canvas>
      </div>
    </div>

    <!-- Contract Split Pie Chart (shown when multiple contracts) -->
    <div id="annual-contract-pie-container" style="display:none;">
      <h4 style="margin:0 0 12px 0; font-size:16px; font-weight:600;">Income by Contract</h4>
      <div style="background:var(--bg); border:1px solid var(--border); border-radius:12px; padding:20px; height:380px; position:relative; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        <canvas id="annual-contract-pie-chart"></canvas>
      </div>
    </div>

    <!-- Total Hours by Month Donut Chart -->
    <div id="annual-total-hours-pie-container">
      <h4 style="margin:0 0 12px 0; font-size:16px; font-weight:600;">Hours by Month</h4>
      <div style="background:var(--bg); border:1px solid var(--border); border-radius:12px; padding:20px; height:380px; position:relative; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        <canvas id="annual-total-hours-pie-chart"></canvas>
      </div>
    </div>

    <!-- Total Hours by Type Donut Chart -->
    <div id="annual-total-hours-by-type-pie-container">
      <h4 style="margin:0 0 12px 0; font-size:16px; font-weight:600;">Hours by Type</h4>
      <div style="background:var(--bg); border:1px solid var(--border); border-radius:12px; padding:20px; height:380px; position:relative; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        <canvas id="annual-total-hours-by-type-pie-chart"></canvas>
      </div>
    </div>
  </div>

  <!-- Tax Analysis Section -->
  <div id="annual-tax-analysis" style="margin-bottom:24px;">
    <h4 style="margin:0 0 12px 0; font-size:16px;">Tax Analysis</h4>
    <div style="background:var(--bg); border:1px solid var(--border); border-radius:10px; padding:16px;">
      <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:12px;">
        <div>
          <div style="font-size:12px; color:var(--muted); margin-bottom:4px;">Estimated Tax Paid</div>
          <div id="annual-tax-paid" style="font-size:20px; font-weight:600;">--</div>
        </div>
        <div>
          <div style="font-size:12px; color:var(--muted); margin-bottom:4px;">Expected Tax</div>
          <div id="annual-tax-expected" style="font-size:20px; font-weight:600;">--</div>
        </div>
        <div>
          <div style="font-size:12px; color:var(--muted); margin-bottom:4px;">Difference</div>
          <div id="annual-tax-difference" style="font-size:20px; font-weight:600; cursor:help;" title="This analysis is only useful towards the end of the financial year. The tax you pay each pay period is calculated assuming that is your average for the entire year, while the expected tax field is based on the assumption that your taxable income is finished for the year.">--</div>
        </div>
      </div>
      <div style="margin-top:12px; padding-top:12px; border-top:1px solid var(--border);">
        <p class="ts-note" style="margin:0;">Tax estimates based on Australian tax brackets for FY 2025/2026 including Medicare levy. Actual tax may vary based on offsets and other factors.</p>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="ts-note" id="annual-empty" style="display:none; text-align:center; padding:40px;">No data found for the selected year.</div>
</section>
